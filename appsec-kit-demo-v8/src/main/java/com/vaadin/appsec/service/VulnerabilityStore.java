package com.vaadin.appsec.service;

import java.util.ArrayList;
import java.util.List;

import com.vaadin.appsec.model.osv.response.OpenSourceVulnerability;

public class VulnerabilityStore {

    private List<OpenSourceVulnerability> vulnerabilities;

    private static final class InstanceHolder {
        static final VulnerabilityStore instance = new VulnerabilityStore();
    }

    public static VulnerabilityStore getInstance() {
        return VulnerabilityStore.InstanceHolder.instance;
    }

    public void init(List<OpenSourceVulnerability> vulnerabilities) {
        this.vulnerabilities = vulnerabilities;
    }

    public List<OpenSourceVulnerability> getVulnerabilities() {
        return vulnerabilities;
    }

    public void addVulnerability(OpenSourceVulnerability vulnerability) {
        if (vulnerabilities == null) {
            vulnerabilities = new ArrayList<>();
        }
        vulnerabilities.add(vulnerability);
    }
}
