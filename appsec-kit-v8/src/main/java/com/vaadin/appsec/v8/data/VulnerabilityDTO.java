package com.vaadin.appsec.v8.data;

import javax.validation.constraints.NotNull;
import java.util.Objects;

public class VulnerabilityDTO {

    private String identifier;
    private DependencyDTO dependency;
    private String vaadinAnalysis;
    private String developerAnalysis;

    public VulnerabilityDTO(@NotNull String identifier) {
        this.identifier = identifier;
    }

    public String getIdentifier() {
        return identifier;
    }

    public DependencyDTO getDependency() {
        return dependency;
    }

    public void setDependency(DependencyDTO dependency) {
        this.dependency = dependency;
    }

    public SeverityLevel getSeverityLevel() {
        return dependency.getSeverityLevel();
    }

    public Double getRiskScore() {
        return dependency.getRiskScore();
    }


    public String getVaadinAnalysis() {
        return vaadinAnalysis;
    }

    public void setVaadinAnalysis(String vaadinAnalysis) {
        this.vaadinAnalysis = vaadinAnalysis;
    }

    public String getDeveloperAnalysis() {
        return developerAnalysis;
    }

    public void setDeveloperAnalysis(String developerAnalysis) {
        this.developerAnalysis = developerAnalysis;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        VulnerabilityDTO that = (VulnerabilityDTO) o;
        return identifier.equals(that.identifier) && Objects.equals(dependency, that.dependency);
    }

    @Override
    public int hashCode() {
        return Objects.hash(identifier, dependency);
    }
}
