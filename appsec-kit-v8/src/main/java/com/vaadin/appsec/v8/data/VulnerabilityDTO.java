/*-
 * Copyright (C) 2023 Vaadin Ltd
 *
 * This program is available under Vaadin Commercial License and Service Terms.
 *
 *
 * See <https://vaadin.com/commercial-license-and-service-terms> for the full license.
 */

package com.vaadin.appsec.v8.data;

import javax.validation.constraints.NotNull;
import java.time.Instant;
import java.util.Date;
import java.util.Objects;
import java.util.Set;

import com.vaadin.appsec.backend.model.AppSecData;

/**
 * DTO for a vulnerability instance, used in the UI.
 */
public class VulnerabilityDTO {

    private String identifier;
    private DependencyDTO dependency;
    private String vaadinAnalysis;
    private AppSecData.VulnerabilityStatus developerStatus;
    private String developerAnalysis;
    private Instant developerUpdated;
    private Date datePublished;

    private String details;

    private Set<String> referenceUrls;

    /**
     * Instantiates a new Vulnerability dto.
     *
     * @param identifier
     *            the identifier
     */
    public VulnerabilityDTO(@NotNull String identifier) {
        this.identifier = identifier;
    }

    /**
     * Gets identifier.
     *
     * @return the identifier
     */
    public String getIdentifier() {
        return identifier;
    }

    /**
     * Gets dependency.
     *
     * @return the dependency
     */
    public DependencyDTO getDependency() {
        return dependency;
    }

    /**
     * Sets dependency.
     *
     * @param dependency
     *            the dependency
     */
    public void setDependency(DependencyDTO dependency) {
        this.dependency = dependency;
    }

    /**
     * Gets severity level.
     *
     * @return the severity level
     */
    public SeverityLevel getSeverityLevel() {
        return dependency.getSeverityLevel();
    }

    /**
     * Gets risk score.
     *
     * @return the risk score
     */
    public Double getRiskScore() {
        return dependency.getRiskScore();
    }

    /**
     * Gets vaadin analysis.
     *
     * @return the vaadin analysis
     */
    public String getVaadinAnalysis() {
        return vaadinAnalysis;
    }

    /**
     * Sets vaadin analysis.
     *
     * @param vaadinAnalysis
     *            the vaadin analysis
     */
    public void setVaadinAnalysis(String vaadinAnalysis) {
        this.vaadinAnalysis = vaadinAnalysis;
    }

    /**
     * Gets developer analysis.
     *
     * @return the developer analysis
     */
    public String getDeveloperAnalysis() {
        return developerAnalysis;
    }

    /**
     * Sets developer analysis.
     *
     * @param developerAnalysis
     *            the developer analysis
     */
    public void setDeveloperAnalysis(String developerAnalysis) {
        this.developerAnalysis = developerAnalysis;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o)
            return true;
        if (o == null || getClass() != o.getClass())
            return false;
        VulnerabilityDTO that = (VulnerabilityDTO) o;
        return identifier.equals(that.identifier)
                && Objects.equals(dependency, that.dependency);
    }

    @Override
    public int hashCode() {
        return Objects.hash(identifier, dependency);
    }

    public Date getDatePublished() {
        return datePublished;
    }

    public void setDatePublished(Date datePublished) {
        this.datePublished = datePublished;
    }

    public String getDetails() {
        return details;
    }

    public void setDetails(String details) {
        this.details = details;
    }

    public Set<String> getReferenceUrls() {
        return referenceUrls;
    }

    public void setReferenceUrls(Set<String> referenceUrls) {
        this.referenceUrls = referenceUrls;
    }

    public AppSecData.VulnerabilityStatus getDeveloperStatus() {
        return developerStatus;
    }

    public void setDeveloperStatus(
            AppSecData.VulnerabilityStatus developerStatus) {
        this.developerStatus = developerStatus;
    }

    public Instant getDeveloperUpdated() {
        return developerUpdated;
    }

    public void setDeveloperUpdated(Instant developerUpdated) {
        this.developerUpdated = developerUpdated;
    }
}
