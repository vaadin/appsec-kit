package com.vaadin.appsec.backend.util;

import java.util.List;
import java.util.stream.Collectors;

import us.springett.cvss.Cvss;

import com.vaadin.appsec.backend.model.osv.response.Severity;

public class OpenSourceVulnerabilityUtil {

    public static String getAliasesStr(List<String> aliases) {
        return String.join("; ", aliases);
    }

    public static String getCvssVectorsStr(List<Severity> severities) {
        List<String> vectors = severities.stream()
                .map(Severity::getScore)
                .collect(Collectors.toList());
        return String.join("; ", vectors);
    }

    public static String getScoresStr(List<Severity> severities) {
        List<String> scores = severities.stream()
                .map(severity -> Cvss.fromVector(severity.getScore()))
                .map(cvss -> cvss.calculateScore().getBaseScore())
                .map(score -> Double.toString(score))
                .collect(Collectors.toList());
        return String.join("; ", scores);
    }
}
