/*-
 * Copyright (C) 2023 Vaadin Ltd
 *
 * This program is available under Vaadin Commercial License and Service Terms.
 *
 *
 * See <https://vaadin.com/commercial-license-and-service-terms> for the full license.
 */

package com.vaadin.appsec.backend.service;

import java.util.ArrayList;
import java.util.List;

import com.vaadin.appsec.backend.model.osv.response.OpenSourceVulnerability;

/**
 * Provides means to store and fetch vulnerabilities from a static instance.
 */
public class VulnerabilityStore {

    private List<OpenSourceVulnerability> vulnerabilities;

    private static final class InstanceHolder {
        static final VulnerabilityStore instance = new VulnerabilityStore();
    }

    /**
     * @return singleton VulnerabilityStore instance
     */
    public static VulnerabilityStore getInstance() {
        return InstanceHolder.instance;
    }

    /**
     * Initializes the store with the given vulnerabilities
     *
     * @param vulnerabilities
     *            list of vulnerabilities
     */
    public void init(List<OpenSourceVulnerability> vulnerabilities) {
        this.vulnerabilities = vulnerabilities;
    }

    /**
     * Returns all stored vulnerabilities from the store
     *
     * @return list of vulnerabilities
     */
    public List<OpenSourceVulnerability> getVulnerabilities() {
        return vulnerabilities;
    }

    /**
     * Adds the given vulnerability to the store
     *
     * @param vulnerability
     *            vulnerability to add
     */
    public void addVulnerability(OpenSourceVulnerability vulnerability) {
        if (vulnerabilities == null) {
            vulnerabilities = new ArrayList<>();
        }
        vulnerabilities.add(vulnerability);
    }
}
